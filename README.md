# Общая информация
Данный Excel-файл и макросы в нем позволяет загружать данные о публикациях, индексируемых в библиографической реферативной базе данных Scopus, посредством интерфейса RESTful API. Для веб-запросов используются службы WinHTTP 5.1.
Для работы с файлом требуются:
- Компьютер с внешним IP-адресом, с которого  имеется доступ к Scopus по подписке;
- API-ключ с требуемыми настройками доступа, который можно получить, зарегистрировавшись на сайте http://dev.elsevier.com/ и подав заявку на ключ.  API-ключ выдается на организацию под определенное использование. Разрешенные случаи использования приведены по ссылке https://dev.elsevier.com/policy.html. Для использования с данным файлом подойдет ключ с настройками по умолчанию для research information systems с дополнительным разрешением для периодического обновления цитирований, для чего требуется доступ к Citations Count Metadata API.

## Разработчик
Кононов Сергей Анатольевич <skononov@nsu.ru>

# Инструкция
Нажмите кнопку Меню на листе Start, откроется окно Главного меню.

API-ключ указывается в верхнем текстовом поле.

Отметьте "Задачи для выполнения". Они буду выполняться по очередности сверху вниз. Чтобы начать выполнение задач нажмите кнопку "Начать". Во время загрузки в отдельном окне будет отображаться прогресс выполнения задачи, который можно прервать в любой момент, нажав в этом окне кнопку "Отмена". Некоторые задачи имеют собственные настройки.

Во время исполнения задачи "Найти и загрузить публикации" сначала делается поиск публикаций в Scopus по указанным условиям, применяемым по И: диапазон годов выхода публикаций; аффилиация; дополнительные условия поиска, задаваемые с помощью синтаксиса Scopus Advanced Search, затем происходит загрузка списка публикаций с основными метаданными в  таблицу на листе Pubs по 200 публикаций за раз. За каждый год загружается не более 10000 публикаций. Чтобы загрузить большее число, разбейте множество публикаций с помощью дополнительных условий поиска. При двойном клике на текстовом поле "Условия поиска" открывается вспомогательное окно для ввода полей Scopus Advanced Search.

Остальные задачи дополняют информацию о публикациях или удаляют дублирующиеся публикации.

Загрузку данных об индикаторах изданий CiteScore (с 2015 г.), IPP (до 2015 г.), SNIP, SJR можно  делать быстрее, если указать расположение Excel-файла со списком изданий, предварительно скачанного с https://www.scopus.com/sources.uri (Download Scopus Source List).

Загрузка метаданных об аффилиациях, авторах и предметных областях занимает продолжительное время. Если Вы ранее загружали эти данные в другой файл, то можете указать его расположение в текстовом поле под соответствующими задачами, и данные сначала будут копироваться оттуда, а потом дополняться из Scopus. 

Для выбора расположения файлов через диалоговое окно дважды кликните на текстовом поле.

С помощью отдельной кнопки в правой части Главного меню "Найти и удалить дубликаты" можно выполнить "интеллектуальный" поиск и удаление дублирующихся публикаций по DOI или заголовку публикации и изданию. Удаление найденных лишних публикаций происходит после подтверждения пользователем. С помощью кнопки "Очистить книгу" можно удалить все загруженные данные в Excel-книге, сбросив ее в исходное состояние. Кнопка "Экспорт..." позволяет сохранить загруженные данные на листах Pubs и PubAuthors в новую книгу.

Настройки диалогового окна сохраняются вместе с файлом и доступны при следующем открытии.

Для каждого элемента интерфейса имеются всплывающие подсказки.

# Совместимость
Работа приложения проверена в следующей конфигурации системного и прикладного программного обеспечения: Windows 8 (Russian, 64-bit)/Microsoft Excel 2013 (Russian, 64-bit), Windows 10 (Russian, 64-bit)/Microsoft Excel 2016 (Russian, 64-bit).


